@model ConsulTech.Web.Models.ViewModels.Dashboard.DashboardVm
@{
    ViewData["Title"] = "Dashboard";
}
<h1 class="mb-4">Dashboard</h1>

<div class="row g-3">
    <div class="col-md-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6 class="text-muted">Clients</h6>
                <h3 class="mb-0">@Model.TotalClients</h3>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6 class="text-muted">Missions (total)</h6>
                <h3 class="mb-0">@Model.TotalMissions</h3>
                <small class="text-muted">En cours: @Model.MissionsEnCours • À venir: @Model.MissionsAVenir</small>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6 class="text-muted">Budget en cours</h6>
                <h3 class="mb-0">@Model.BudgetTotalEnCours.ToString("N2")</h3>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6 class="text-muted">Consultants</h6>
                <h3 class="mb-0">@Model.ConsultantsTotal</h3>
                <small class="text-muted">Disponibles: @Model.ConsultantsDisponibles</small>
            </div>
        </div>
    </div>
</div>

<div class="row g-3 mt-4">
    <div class="col-lg-6">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Missions à venir</h5>
                @if (Model.UpcomingMissions == null || Model.UpcomingMissions.Count == 0)
                {
                    <div class="text-muted">Aucune mission planifiée.</div>
                }
                else
                {
                    <table class="table table-sm align-middle mb-0">
                        <thead>
                            <tr>
                                <th>Titre</th>
                                <th>Client</th>
                                <th>Début</th>
                                <th class="text-end"></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var m in Model.UpcomingMissions)
                            {
                                <tr>
                                    <td>@m.Titre</td>
                                    <td>@m.ClientNom</td>
                                    <td>@m.Debut.ToShortDateString()</td>
                                    <td class="text-end">
                                        <a class="btn btn-sm btn-outline-primary"
                                           asp-controller="Missions"
                                           asp-action="Details"
                                           asp-route-id="@m.Id">
                                            Ouvrir
                                        </a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
            </div>
        </div>
    </div>

    <div class="col-lg-6">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Consultants disponibles</h5>
                @if (Model.ConsultantsDispos == null || Model.ConsultantsDispos.Count == 0)
                {
                    <div class="text-muted">Aucun consultant disponible.</div>
                }
                else
                {
                    <ul class="list-group list-group-flush">
                        @foreach (var c in Model.ConsultantsDispos)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <div class="fw-semibold">@c.NomComplet</div>
                                    <div class="text-muted small">@c.Email</div>
                                </div>
                                <a class="btn btn-sm btn-outline-secondary"
                                   asp-controller="Consultants"
                                   asp-action="Details"
                                   asp-route-id="@c.Id">
                                    Voir
                                </a>
                            </li>
                        }
                    </ul>
                }
            </div>
        </div>
    </div>
</div>
